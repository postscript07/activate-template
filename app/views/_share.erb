
<style>
  .share-count { font-family: arial,sans-serif; font-size: 12px; background-color: #FFFFFF; border: 1px solid #CDD5E5; height: 14px; margin-left: 3px; padding: 1px 2px; position: relative; }
  .share-count i, .share-count u { border-color: transparent #ccc transparent transparent; border-style: solid; border-width: 4px 5px 4px 0; display: block; height: 1px; position: absolute; top: 4px; left: -5px; }
  .share-count i { border-right-color: white; left: -3px; z-index: 1; }
</style>

<div class="share-buttons" style="margin: 10px 0">
  <a class="popup" href="http://www.facebook.com/sharer/sharer.php?u=<%=url%>"><img src="<%=image_path('share/facebook.png')%>" /></a>
  <span class="facebook share-count"><i></i><u></u></span>
  <script>
    $(function() {
      $.getJSON('http://graph.facebook.com/?ids=<%=url%>', function(data) {
        $('.facebook.share-count').append(data['<%=url%>']['shares'] || 0);
      });
    });
  </script>

  <a class="popup" href="http://twitter.com/intent/tweet?<%=[:url,:via,:text,:in_reply_to,:hashtags,:related].map { |x| begin "#{x}=#{eval(x.to_s)}" rescue nil; end }.compact.join('&') %>"><img src="<%=image_path('share/twitter.png')%>" /></a>
  <span class="twitter share-count"><i></i><u></u></span>  
  <script>
    $(function() {
      $.getJSON("http://urls.api.twitter.com/1/urls/count.json?url=<%=url%>+&callback=?", function(data) {
        $('.twitter.share-count').append(data['count']);
      });
    });
  </script>

</div>

